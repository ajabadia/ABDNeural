# NEURONiK: Master Development Roadmap & Specification

Este documento sirve como la guÃ­a tÃ©cnica y filosÃ³fica para el desarrollo de NEURONiK, un instrumento de resÃ­ntesis inspirado en la tecnologÃ­a de modelos neurales (Hartmann Neuron), diseÃ±ado para alta eficiencia en mÃºltiples plataformas (PC, Mac, Linux, RPi).

---

## ðŸŸ¢ FASE 0-8: FUNDAMENTOS Y SÃNTESIS [COMPLETADO]
*Objetivo: Establecer una base de cÃ³digo robusta y un motor de sÃ­ntesis expresivo.*

- [x] **Arquitectura y UI**: Sistema de pestaÃ±as, abstracciÃ³n de parÃ¡metros y optimizaciÃ³n del hilo de audio.
- [x] **Motor de Modelos Espectrales**: MigraciÃ³n a un sistema de sÃ­ntesis basado en modelos de 64 parciales, con capacidad de morphing lineal (A/B).
- [x] **Escultura de Materia Sonora**: ImplementaciÃ³n de los parÃ¡metros `Inharmonicity` y `Roughness` para la transformaciÃ³n del timbre.

---

## ðŸŸ¢ FASE 10: NAVEGACIÃ“N AVANZADA [COMPLETADO]
*Objetivo: Implementar un sistema de morphing 2D para un control tÃ­mbrico superior.*

- [x] **Tarea 10.1: Neural Pad (Componente X/Y)**: Se ha reemplazado el morphing lineal por un pad X/Y que permite la mezcla entre cuatro modelos espectrales (A, B, C, D).
- [x] **Tarea 10.2 (Parcial): Bugs CrÃ­ticos Solucionados**: Se ha corregido el bug de la nota MIDI fija y se ha eliminado el visualizador duplicado de la UI.

---

## ðŸŸ¢ FASE 14: REFINAMIENTO DE USABILIDAD (UI/UX) [COMPLETADO]
*Objetivo: Mejorar el flujo de trabajo y la claridad de la interfaz basÃ¡ndose en la experiencia de uso.*

- [x] **Tarea 14.1: ReorganizaciÃ³n del Panel `RESONATOR`**: Se han movido los controles de `Inharmonicity` y `Roughness` desde el `DASHBOARD` al `RESONATOR` para agrupar todos los controles de escultura de timbre junto al XYPad.
- [x] **Tarea 14.2: Visualizador Espectral Global**: 
    -   Se ha movido el `SpectralVisualizer` a la cabecera de la UI, siempre visible en la mitad derecha.
    -   Se ha implementado una escala de potencia (gamma) para mejorar la visibilidad de armÃ³nicos de baja amplitud.
- [x] **Tarea 14.3: BotÃ³n de AleatorizaciÃ³n ("Randomize")**: AÃ±adido botÃ³n "RANDOM" que genera timbres musicales coherentes y notifica cambios al host.

---

## ðŸŸ¢ FASE 15: MODULACIÃ“N AVANZADA (LFOs) [COMPLETADO]
*Objetivo: Dotar a NEURONiK de LFOs como fuentes de modulaciÃ³n flexibles.*

- [x] **Tarea 15.1: Motor de LFO en DSP (BÃ¡sico)**: Creada la clase `LFO` con formas de onda estÃ¡ndar, `Rate` (con DAW Sync) y `Depth`.
- [x] **Tarea 15.2: Matriz de ModulaciÃ³n (Simple)**: DiseÃ±ado e implementado el sistema que conecta las fuentes (LFOs) con los destinos (parÃ¡metros) en `NEURONiKProcessor`.
- [x] **Tarea 15.3: Interfaz de Usuario para ModulaciÃ³n**: Creada la nueva pestaÃ±a `LFO/MOD` en la UI para controlar los LFOs y la matriz de modulaciÃ³n.

---

## ðŸŸ¡ FASE 12: GESTIÃ“N Y CONTROL TOTAL [EN CURSO]
*Objetivo: Dotar a NEURONiK de un sistema de gestiÃ³n de sonidos profesional y control MIDI completo.*

### Tarea 12.1: Sistema de Presets (.neuronikpreset) [EN CURSO]
- [x] **EspecificaciÃ³n**: Implementar la capacidad de guardar y cargar el estado completo del sintetizador.
- [x] **Backend**: Clase `PresetManager` implementada con persistencia en XML.
- [x] **UI BÃ¡sica**: Implementado `ComboBox` (desplegable) en el panel `Parameters` para selecciÃ³n rÃ¡pida, reemplazando los botones anticuados.
- [x] **UI Avanzada**: Creada pestaÃ±a "BROWSER" con 3 columnas (Bank, Preset, Info) y funcionalidad de bÃºsqueda, inspirada en sintetizadores modernos como Osirus.

### Tarea 12.2: Carga de Modelos Espectrales (.neuronikmodel) [PARCIALMENTE COMPLETADO]
- [x] **UI**: AÃ±adir cuatro botones ("Load A", "Load B", etc.) en el `OscillatorPanel`.
- [x] **LÃ³gica**: Implementar la carga de archivos JSON.
- [ ] **Soporte Headless**: El preset deberÃ¡ guardar las rutas a los archivos `.neuronikmodel` utilizados.

### Tarea 12.3: Mapeo de MIDI CC y Controles EstÃ¡ndar
- [x] **Sub-tarea 12.3.1 (Hard-coded)**: Implementar Pitch Bend, Sustain Pedal, Mod Wheel, Main Volume.
- [x] **Sub-tarea 12.3.2 (MIDI Learn) [UI IMPLEMENTADA]**: Implementar la lÃ³gica de mapeo dinÃ¡mico, con gestiÃ³n desde la UI de escritorio (menÃº contextual) y desde la UI headless (doble pulsaciÃ³n / pulsaciÃ³n larga).
- [x] **Sub-tarea 12.3.3 (MIDI Thru) [COMPLETADO]**: Implementado parÃ¡metro global y lÃ³gica de reenvÃ­o en `processBlock`.
- [x] **Sub-tarea 12.3.4 (Canal MIDI) [UI COMPLETADA]**: AÃ±adir selector de canal MIDI de entrada (Omni, 1-16). CorrecciÃ³n de bug crÃ­tico en filtrado de canales (Float vs Int).
- [x] **Sub-tarea 12.3.8 (Tempo Standalone / Interno)**: Implementado parÃ¡metro `masterBPM` que actÃºa como fuente de tiempo cuando no hay host DAW/MIDI Clock. AÃ±adido control visual en la pestaÃ±a GENERAL.
- [x] **Sub-tarea 12.3.5 (Pitch Bend como Modulador)**: Implementado Pitch Bend y Mod Wheel como fuentes en la matriz de modulaciÃ³n.
- [x] **Sub-tarea 12.3.6 (CorrecciÃ³n de SincronÃ­a LFO)**: Corregido bug donde los LFOs avanzaban solo 1 muestra por bloque de audio. Implementada lÃ³gica de avance por bloques y mapeo de divisiones rÃ­tmicas.
- [x] **Sub-tarea 12.3.7 (Escalado de ModulaciÃ³n)**: Corregido bug de escalado en la matriz donde los valores modulados no respetaban el rango real del parÃ¡metro destino (especialmente crÃ­tico en Filtro y Envolventes).

---

## ðŸŸ¢ FASE 16: REFINAMIENTO DE SONIDO Y USABILIDAD [COMPLETADO]
*Objetivo: Ajustar parÃ¡metros de sÃ­ntesis y mejorar la claridad de la interfaz basÃ¡ndose en la experiencia de uso.*

- [x] **Tarea 16.1: Ajuste del ParÃ¡metro `Roughness`**: Reducir el rango mÃ¡ximo del parÃ¡metro `Roughness` a la mitad (ej. de 1.0 a 0.5) para que su efecto sea mÃ¡s musical y se controle la generaciÃ³n de ruido excesivo.
- [x] **Tarea 16.2: VisualizaciÃ³n de Nombres en XY Pad**: Mostrar el nombre del modelo cargado en cada una de las cuatro esquinas (A, B, C, D) del XY Pad en la pestaÃ±a `RESONATOR`. Esto proporcionarÃ¡ una referencia visual clara de hacia dÃ³nde se estÃ¡ realizando el morphing.
- [x] **Tarea 16.3: Robustez de Audio y PolifonÃ­a**: Implementada opciÃ³n de lÃ­mite de voces (1-8 voces) en el menÃº "Edit" para gestiÃ³n de recursos. Optimizado generador de aleatoriedad (Xorshift32) para eliminar cracks en alta polifonÃ­a. Solucionados clicks de re-disparo en modo mono.

---

## âš« FASE 17: GESTIÃ“N DE PRESETS AVANZADA [PENDIENTE]
*Objetivo: Mejorar la gestiÃ³n y manipulaciÃ³n de presets.*

- [ ] **Tarea 17.1: Copiar/Pegar ParÃ¡metros de Patch**: Implementar la funcionalidad de copiar y pegar todos los parÃ¡metros de un patch a otro. Esta opciÃ³n estarÃ¡ disponible en un futuro menÃº "Edit".
- [ ] **Tarea 17.2: Gestor de Presets en PestaÃ±a GENERAL**: AÃ±adir un gestor de presets en la pestaÃ±a "GENERAL" para navegar, cargar y guardar presets de forma visual e intuitiva, siguiendo estÃ¡ndares de plugins modernos.

---

## ðŸŸ¤ FASE 13: INTERFAZ DE HARDWARE VIRTUAL (Pantalla LCD) (PENDIENTE)
*Objetivo: Reemplazar el tÃ­tulo estÃ¡tico por una pantalla LCD informativa y funcional, clave para el modo headless.*

- [ ] **EspecificaciÃ³n de Hardware**: La pantalla LCD serÃ¡ de tipo 16x2 (16 caracteres, 2 filas) para asegurar la compatibilidad con el hardware de referencia de [MiniDexed](https://github.com/probonopd/MiniDexed) en la futura versiÃ³n para Raspberry Pi.
- [ ] **Tareas 13.1 a 13.4**: Implementar el componente `LcdDisplay`, la lÃ³gica de navegaciÃ³n por bancos de parÃ¡metros, la gestiÃ³n de archivos desde el LCD y la abstracciÃ³n para hardware fÃ­sico.
- [x] **Tarea 13.5: Mover TÃ­tulo a PestaÃ±a GENERAL**: Mover el tÃ­tulo "NEURONiK" y la versiÃ³n a la pestaÃ±a "GENERAL" para liberar el espacio del cabecera para la pantalla LCD.

### Referencia de MenÃºs para Hardware (Estilo Vintage)
Esta secciÃ³n recopila informaciÃ³n sobre estructuras de menÃº y valores tÃ­picos de sintetizadores hardware para guiar el desarrollo de la interfaz LCD.

```
Estructura General
text
GLOBAL
â”œâ”€â”€ TUNE > 440 | Master Tune (A4=440Hz Â±100 cents) [web:6]
â”œâ”€â”€ TRANS > 0 | Transpose (-12..+12 semitones) [web:6]
â””â”€â”€ VOL > 100 | Master Volume (0-127) [web:9]

PRESET
â”œâ”€â”€ BANK > A1 | Bank Select (A-H, 1-8) [web:6]
â”œâ”€â”€ NAME > BASS | Preset Name (8-16 chars, ej. BASS, LEAD1) [web:6]
â””â”€â”€ LEV > 100 | Preset Level (0-127) [web:9]
MIDI ConfiguraciÃ³n
text
MIDI
â”œâ”€â”€ CH > 1 | Channel (1-16, OMNI) [web:9]
â”œâ”€â”€ OUT > ON | Output (ON/OFF) [web:6]
â”œâ”€â”€ THRU > ON | Thru (ON/OFF) [web:6]
â”œâ”€â”€ PROG > ON | Program Change (ON/OFF) [web:9]
â””â”€â”€ BEND > 2 | Bend Range (0-12 semitones) [web:6]
Efectos y Controles
text
EFFECT
â”œâ”€â”€ PORT > 0 | Portamento Time (0-99) [web:6]
â”œâ”€â”€ GLID > 12 | Glide Note (Â±12 semitones) [web:6]
â”œâ”€â”€ CHOR > ON | Chorus (ON/OFF) [web:6]
â”œâ”€â”€ MOD.W > 50 | Mod Wheel Depth (0-99) [web:6]
â”œâ”€â”€ MOD.A > 50 | Mod Aftertouch Depth (0-99) [web:6]
â””â”€â”€ AMP.A > 15 | Amp Aftertouch Range (0-15) [web:6]

INST
â”œâ”€â”€ OCT > 0 | Octave Shift (-2..+2) [web:6]
â”œâ”€â”€ DETU > 5 | Detune (0-50 cents) [web:6]
â”œâ”€â”€ VEL > 7 | Velocity Sens (0-7, LINE1/LINE2) [web:6]
â””â”€â”€ BEND > Â±2 | Bender Range (Â±2, Â±5, Â±7, Â±12) [web:18]
Envolventes (Scroll PÃ¡ginas)
text
ENV.DCO1 (Pitch Env LINE1)
â”œâ”€â”€ STEP1 > R99 L99 | Rate1/Level1 (0-99) [web:6]
â”œâ”€â”€ SUS > 3 | Sustain Point (1-8) [web:6]
â””â”€â”€ END > 0 | End Point (0-99) [web:6]

ENV.DCW1 (Timbre Env LINE1)
â”œâ”€â”€ STEP1 > R50 L80 | Rate1/Level1 (0-99) [web:6]
â””â”€â”€ KF > ON | Key Follow (ON/OFF) [web:6]
Valores tÃ­picos en LCD: Abviaturas como "TUNE=440", scroll con PAGE UP/DOWN para subscreens; nÃºmeros 0-99 comunes por resoluciÃ³n 7-bit.  //// ParÃ¡metros Globales
TUNE: Master tuning (A=440Hz Â±50 cents)

TRANS: Transpose (-12 a +12 semitonos)

VOL: Master volume (0-127)

OCT: Octave shift (-2 a +2)

PORT: Portamento time (0-99 ms)

MIDI y Controles
CH: MIDI channel (1-16, OMNI)

OUT: MIDI out (ON/OFF)

THRU: MIDI thru (ON/OFF)

BEND: Pitch bend range (Â±2, Â±5, Â±7, Â±12)

VEL: Velocity sensitivity (0-7, LINEAR)

Envolventes y Osciladores
ATT: Attack time (0-99)

DEC: Decay time (0-99)

SUS: Sustain level (0-99)

REL: Release time (0-99)

DETN: Detune (0-50 cents)

DCW: DCW level (0-99)

Efectos y ModulaciÃ³n
CHOR: Chorus depth (0-99, ON/OFF)

MOD: Modulation depth (0-99)

LFO.R: LFO rate (0-99)

LFO.S: LFO shape (TRI, SAW, SQR)

ENV: Envelope select (DCO1, DCW1, DCA)

Estos valores se mostraban en formato "PARAM=VAL" con scroll para subs, adaptados a lÃ­mites de LCD vintage.  //// Los sintetizadores de los 80/90 expandÃ­an sus LCD con mÃ¡s parÃ¡metros detallados en subscreens, mostrando valores numÃ©ricos precisos y opciones abreviadas para envelopes, LFO y efectos. AquÃ­ va una ampliaciÃ³n con mÃ¡s ejemplos reales de Casio CZ, DX7 y similares, incluyendo rangos completos.

Envolventes Detalladas
text
ENV.DCO (Pitch Envelope)
â”œâ”€â”€ RATE1 > 0-99 | Attack rate
â”œâ”€â”€ LEVEL1 > 0-99 | Peak level
â”œâ”€â”€ RATE2 > 0-99 | Decay rate
â”œâ”€â”€ RATE3 > 0-99 | Sustain rate
â”œâ”€â”€ RATE4 > 0-99 | Release rate
â””â”€â”€ KEYF > ON/OFF | Key follow

ENV.DCW (Wave Envelope)
â”œâ”€â”€ STEP1 > R99 L99 | Rate/Level step 1 (8 steps)
â”œâ”€â”€ SUSPT > 1-8 | Sustain step
â””â”€â”€ KFS > -2..+2 | Key scale (-2 a +2)
LFO y ModulaciÃ³n
text
LFO
â”œâ”€â”€ WAVE > TRI,SAW,SQR,RND | Waveform (Triangle, Saw, Square, Random)
â”œâ”€â”€ RATE > 0-99 | Speed (0=slow, 99=fast)
â”œâ”€â”€ DLY > 0-99 | Delay time
â”œâ”€â”€ PMD > 0-99 | Pitch mod depth
â”œâ”€â”€ AMD > 0-99 | Amp mod depth
â””â”€â”€ SYNC > ON/OFF | Key sync
Valores tÃ­picos: PMD=30 para vibrato sutil; RATE=50 para tremolo medio.


Filtros y Amplificador
text
FILTER
â”œâ”€â”€ FC > 0-99 | Cutoff frequency
â”œâ”€â”€ RES > 0-99 | Resonance (self-osc ~99)
â”œâ”€â”€ EG.INT > -50..+50 | Envelope intensity
â””â”€â”€ KEYF > 0-2 | Keyboard track (0=off,1=normal,2=wide)

DCA (Amp)
â”œâ”€â”€ LEVEL > 0-99
â””â”€â”€ VEL > 0-7 (LINEAR1-2,FIXED)
Efectos Comunes
CHORUS: DEP=0-15, SPD=0-15, DL=0-15 (Depth, Speed, Delay)

REVERB: TIME=0-99, LEVEL=0-99 (raro en 80s portables)

NOISE: LEVEL=0-99, TYPE=WHIT/PINK

VELO CURVES: LINE1, LINE2, EXP1-3 (DX7 style)


Valores MIDI Expandidos
text
MIDI
â”œâ”€â”€ LOCAL > ON/OFF | Local control
â”œâ”€â”€ PROGCH > 1-16 | Program change ch
â”œâ”€â”€ SYSX > ON/OFF | SysEx transmit
â”œâ”€â”€ CLK > INT/EXT | Clock source (Internal/External)
â””â”€â”€ PRIOR > HIGH/LOW | Priority (Poly/Mono)
Pantallas como "MIDI CH=10 LOC=ON" o scroll "PROG=ON THRU=OFF"   ////  Mixer y Niveles
text
MIXER
â”œâ”€â”€ DCO1 > 0-99 | Osc 1 level
â”œâ”€â”€ DCO2 > 0-99 | Osc 2 level  
â”œâ”€â”€ NOIS > 0-99 | Noise level
â”œâ”€â”€ EXT > 0-99 | External input
â””â”€â”€ BAL > L50-R50 | Stereo balance
Key Scaling y Velocity
text
KEY SCALE
â”œâ”€â”€ BREAK > C3 | Break point (C-1 a G9)
â”œâ”€â”€ L.SLOPE > -10..+10 | Left slope
â”œâ”€â”€ R.SLOPE > -10..+10 | Right slope
â””â”€â”€ L.CURV > -7..+7 | Left curve

VELOCURV > LIN1,LIN2,EXP1-3 | Velocity curve [web:16]
Arpeggiator y Secuencer
text
ARPEGG
â”œâ”€â”€ MODE > UP,DN,UPDN,RND | Up/Down/UpDown/Random
â”œâ”€â”€ RANGE > 1-4 | Octave range
â”œâ”€â”€ BPM > 30-300 | Tempo
â””â”€â”€ HOLD > ON/OFF | Hold mode
Patch y Memoria
text
MEMORY
â”œâ”€â”€ SAVE? > YES/NO | Save current patch
â”œâ”€â”€ LOAD > A01 | Load preset (A01-H88)
â”œâ”€â”€ NAME > LEAD1 | 8-char name (scroll)
â””â”€â”€ COPY > 1->2 | Copy src->dst [web:6]
Global Avanzado
text
SYSTEM
â”œâ”€â”€ TOUCH > LIGHT,NORM,HEAVY | Keyboard sensitivity
â”œâ”€â”€ CURSOR > BLINK,OFF | Display cursor
â”œâ”€â”€ CONTRAST > 0-15 | LCD contrast
â”œâ”€â”€ DUMP > ALL,BANK | SysEx dump type
â””â”€â”€ RESET > YES/NO | Factory reset [web:9]
Pantalla tÃ­pica: "MIX DCO1=99 DCO2=50" o "ARPG UP RNG=3 BPM=120". Scroll con [PAGE] para ver pasos completos de envelopes (8 steps en CZ)  /// NO TODOS LOS PONDREMOS, PERO HAY ALGUNOS QUE HABRÃ QUE DESARROLLAR ALGO, TAMBIÃ‰N FALTAN LOS CASOS COMO NUESTROS CONTROLES, LA ASIGNACION DE CC A CADA CONTROL,

los LCD mostraban valores de bancos vÃ­a MSB (CC#0, 0-127) y LSB (CC#32, 0-127) para seleccionar presets mÃ¡s allÃ¡ de 128, combinados con Program Change (PC 0-127). Estos se visualizaban abreviados como "BANK MSB=00 LSB=01 PC=05" o "BNK=1 PRG=16" en scroll.

Estructura MIDI Bank Select
text
BANK SELECT
â”œâ”€â”€ MSB > 00-127 | Most Significant Byte (CC#0, coarse bank)
â”œâ”€â”€ LSB > 00-127 | Least Significant Byte (CC#32, fine bank)
â””â”€â”€ PC > 0